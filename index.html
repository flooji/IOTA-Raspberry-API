<!-- web client for a simple server-side application to demonstrate running a node API Appserver on a Raspberry Pi to display I/O values in a web browser -->
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>My Raspbery Pi API server example</title>
        <script src="http://code.jquery.com/jquery-latest.js"></script>
        
        <script src="myclient.js"></script>
    </head>
    <body>
        <H1>My Raspbery Pi API server example</H1>
        <div id="input"></div>
        <div id="output"></div>
        <script>
                window.onload = function () {
                var urlA, i;
              
                for (i = 0; i < 2; i++) {
                  urlA = document.URL + 'inputs/' + i;
                  $.getJSON(urlA, function (data) {
                    console.log('API response received');
                    $('#input').append('<p>input gpio port ' + data.gpio + ' on pin ' + data.pin + ' has current value ' + data.value + '</p>');
                  });
                }
                

                let url = document.URL + 'create-claim' 
                let urlToken = document.URL + 'authenticate/' 
                let params = {
                  headers: {
                    "content-type":"application/json; charset=UTF-8"
                  },
                  body: {
                    data: {
                      commodityGroup: 'Cameras',
                      seriesNumber: '101010',
                      numberOfItems: '38',
                      valueOfItem: '59',
                      currencyOfPrice: 'CHF',
                      owner: 'Sony Corporation',
                      deliveryDate: '27/01/2019'
                    }
                  },
                  method: 'POST'
                }
                fetch(url,params)
                .then((response) => {
                  return response.json()
                }).then((jsonObj) => {
                  document.getElementById('output').innerHTML = jsonObj.claim.root
                  console.log('it worked')
                  console.log(jsonObj)
                }).catch((err) => console.log(err))
              }
            </script>
    </body>
</html>
